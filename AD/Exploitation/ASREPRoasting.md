

- ASREPRoasting is one of the most popular attacks in an AD environment that allows an attacker to compromise accounts that have **kerberos pre-authentication** Disabled.
- It is a pre-authentication exploit, meaning an attacker can carry out ASREPRoasting, without access to credentials of any sort





### What the heck is even Kerberos Pre-authentication?


Kerberos Pre-Auth is a security mechanism that ensures a user is actually who they clam to be before the KDC proceeds to issue them a TGT.

Without pre-auth, an attacker could :

- Send requests to the KDC pretending to be any user
- receive encrypted responses
- use bruteforce to crack the encrypted response to retrieve the user password.



### What is a TGT?

- A TGT (Ticket Granting Ticket) is a kerberos authentication token that allows a user to prove their identity to the domain, without needing to enter their password everytime.
- A TGT is issued by the KDC after successful auth to the KDC.
- It allows users to request for Service tickets to access services. 


### How Pre-Auth Works.


1. The user sends a TGT request to the KDC
2. The KDC requests for an identity verification before a TGT is issued
3. The user encrypts the timestamp with their NTLM hash and sends it
4. The KDC decrypts the encrypted timestamp with the NTLM hash of the user
5. If successfully decrypted, the user identity is verified and the TGT is issued.






### Anatomy of ASREPRoasting


1. The attacker looks for user accounts that have kerberos pre-auth disabled
2. The attacker requests a TGT from the KDC on behalf of that User.
3. The KDC responds with an encrypted AS-REP (Authentication Server Reply)
	1. The 



