
- ICMP tunneling encapsulates your traffic within ICMP packets containing echo requests and responses.
- When a host within a firewalled network is allowed to ping an external server, it can encapsulate its traffic within the echo request and send it to the external server.
- The external server can then validate this traffic and send an appropriate response. 
- This can be extremely useful for data exfiltration



#### ICMP tunneling using ptunnel-ng

We will use the ptunnel-ng tool to create a tunnel between our ubuntu server and our attack host. Once the tunnel is created, we will be able to proxy our traffic through the `ptunnel-ng client`.



#### Syntax

1. Starting a ptunnel-ng server on the target host.

```bash
./ptunnel-ng -r <pivotBoxip> -R <portToExposeToTheTunnel>
```


2. Connecting to the ptunnel-ng server from the attack Host

```bash
./ptunnel-ng -p <PivotBoxIP> -l2222 -r <PivotBoxIP> -R <portToExposeToTheTunnel>
```


#### Important clarification

It's important to perform ICMP tunneling through local port 2222





#### Example Scenario : Connecting to SSH via ICMP tunneling


1. Starting up the ptunnel-ng server on the PivotBox 

```bash
sudo ./ptunnel-ng -r10.10.10.10 -R22
```



2. Connecting to the ptunnel-ng server from the attack Host

```bash
5epi0l@pwnbox[~]$ 
```