

Netsh is windows command-line tool that can help with the network configuration of a particular windows system. It can help :

1. Finding routes
2. Viewing FW configuration
3. Adding Proxies
4. Creating Port Forwarding Rules



#### Scenario

Suppose we've compromised a windows host (10.129.15.150). Upon further recon, we notice that it has an internal network 172.16.5.0/24. Performing a ping sweep on this network, we come across a host 172.16.5.19 that is listening on port 3389. Also suppose, we have compromised RDP credentials using various tactics. Now, we would want to pivot to the 172.16.5.19. 

To do this, we can use netsh to create a portforwarding rule. This will make the pivot box listen on a specific port and forward all traffic arriving on that port to this internal host on port 3389. 




#### Syntax

1. Using netsh.exe to portforward

```python
netsh.exe interface portproxy add v4tov4 listenport=9999 listenaddress-10.129.251.149 connectport=3389 connectaddress=172.16.5.19
```



2. RDP into the internal host via the pivot box

```python
xfreerdp3 /u:username /p:password /v:10.129.251.149:9999 
```


