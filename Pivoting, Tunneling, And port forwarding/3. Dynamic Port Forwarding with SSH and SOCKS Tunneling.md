

#### Port Forwarding

 - Port forwarding is a networking technique that allows us to redirect a communication request from one port to another. 
 - Port Forwarding uses TCP as the primary protocol. However, different protocols such as SSH or SOCKS an be used to encapsulate the forwarded traffic. 





#### SSH Local Port Forwarding


- SSH Local port forwarding is a technique that allows us to make a remote service running on a remote host accessible to our local machine via SSH. 
- It maps the remote service port to a local port on our machine and tunnels all traffic sent to the local port to the remote port through the SSH session. 
- It is done to expose a **Remote Service** to the Local Machine




#### Syntax

```bash
ssh -L 1234:127.0.0.1:3306 username@hostname
```


The -L command tells the SSH client to request the SSH server  to forward all data that we send via the port `1234` to `localhost:3306` on the ubuntu server. 

Now, any traffic that we issue to our local port will be tunneled through the SSH connection to the remote port.




#### Dynamic Port Forwarding

- Dynamic Port Forwarding is a network technique that allows us to turn a remote host into a SOCKS proxy that will route traffic from it to the internal network.  
- This is essential for pivoting as our local system does not have the required routes to reach the isolated target network segment (Only the remote host can access it)
- Once we setup Dynamic Port Forwarding,  tools and browsers on our local machine can send traffic through the **SOCKS proxy**, and reach **any internal systems the remote host can access**.
- We **don’t need to define specific destination IPs or ports** — unlike local or remote forwarding — because the routing happens dynamically.


#### Dynamic Port Forwarding Via ssh

- We can do this by starting a SOCKS listener on our localhost and then configure SSH to forward all traffic sent to this SOCKS listener to the target network components after connecting to the remote host.



#### Example Scenario : 

Suppose we have pwned a linux server on LAN. The server has two NICs, say eth0 and eth1. eth0 has the ip address `192.168.56.12` and eth1 has the ip address `10.10.11.34`. We want to pivot to the eth1 network via the compromised host. So, we can start to scan the eth1 network. But we cannot scan it directly from our end as our machine lacks the routes to reach this internal network. Thus, we setup Dynamic Port Forwarding via ssh. We setup a SOCKS listener  on our local host and ask SSH to forward all traffic being sent to the SOCKs listener to the remote network (eth1). In this way, the remote host turns into a SOCKS proxy that dynamically routes traffic from attacker's machine to the internal network.